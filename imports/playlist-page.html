<template name="playlist_page">
{{#if playlist}}
<div class="playlistTitle">
  {{#if isOwner}}
  <div class="playlistSettings icon-action">
    <a id="settings-action"><span class="icon-content"><i class="fa fa-cog fa-1x" aria-hidden="true"></i></span></a>
  </div>
  {{/if}}
  <h2 id="playlist-name">
    {{playlist.name}}
  </h2>
</div>

<div class="actionBar">
  <div class="playlistShare icon-action">
    <p>
    <a href="{{getShareLinkByOS}}">
      <span class="icon-content"><i class="fa fa-bullhorn fa-1x"></i>#{{playlist.publicId}}</span>
    </a>
    </p>
  </div>
  <div class="playlistSave icon-action">
    <a id="save-action"><span class="icon-content"><i class="fa fa-floppy-o" aria-hidden="true"></i></span></a>
  </div>
</div>

<!--
  <div>
    {{#if isOwner}}
      <a>Settings</a>
    {{/if}}
  </div>
-->

  <!-- search bar -->
  {{> search playlistId=playlist._id}}

  <!-- music player - TODO - complete this -->
  {{#if isControllable}}
  <div class="musicPlayer">
  <div class="musicActions">
    <div class="musicAction icon-action">
      <a style="" id="playPreviousSong"><i class="fa fa-step-backward fa-2x" aria-hidden="true"></i></a>
      </div>
      <div class="musicAction icon-action">
      {{#if isPlaying}}
        <a id="pauseSong"><i class="fa fa-pause fa-2x" aria-hidden="true"></i></a>
      {{else}}
        <a id="playSong"><i class="fa fa-play fa-2x" aria-hidden="true"></i></a>
      {{/if}}
      </div>
      <div class="musicAction icon-action">
      <a id="playNextSong"><i class="fa fa-step-forward fa-2x" aria-hidden="true"></i></a>
    </div>
    </div>
  </div>
  {{/if}}

  <!-- current songs -->
  <div class="playlistContainer">
    {{#if songs}}
	  <div class="nowPlayingHeader"><h3>Now playing</h3></div>
      <ul class="playlist">
      <li>
        {{#if currentSong}}
          <span class="songName">{{currentSong.name}}</span> {{#if isOwner}}<span class="voteContainer delete-action" id="{{currentSong._id}}"><i class="fa fa-trash"></i></span>{{/if}} <span class="voteContainer vote-action" id="{{song._id}}"><span class="votes"><strong>{{currentSong.votes.length}}</strong></span><span class="voter"><i class="{{hasVotedClass song.votes}}"></i></span></span> <br/>
          <span class="songArtist">{{currentSong.artist}}</span>
        {{else}}
          {{#if isFinished}}
            <i>
              Playlist finished!
            </i>
            <br/>
              Add more songs to keep it going!
          {{else}}
            <i>Waiting for host to begin</i>
          {{/if}}
        {{/if}}
      </li>
      {{#each song in songs}}
        <li class="song-row">
        <div style="float: left;">
          <img src="{{song.imageUrl}}"/>
        </div>
        <div class="songInfo">
        <span class="songName">{{song.name}}</span>
        {{#if isOwner}}
          <span class="voteContainer delete-action" id="{{song._id}}"><i class="fa fa-trash"></i></span>{{/if}} 
          <span class="voteContainer vote-action" id="{{song._id}}">
            <span class="votes"><strong>{{song.votes.length}}</strong></span>
            <span class="voter"><i class="{{hasVotedClass song.votes}}"></i></span>
          </span>
          <br/>
        <span class="songArtist">{{song.artist}}</span>
        </div>
        </li>
      {{/each}}
      </ul>
    {{else}}
      Playlist is empty
    {{/if}}
  </div>

  <!-- previous songs -->
  {{#if hasPastSongs}}
  <div class="ui horizontal divider">
    <span style="color: #ccc">Played</span>
  </div>

  <div class="pastPlaylistContainer">
    
      <ul class="playlist">
      <li></li>
      {{#each song in previousSongs}}
        <li>
        <span class="songName">{{song.name}}</span><br/>
        <span class="songArtist">{{song.artist}}</span>
        </li>
      {{/each}}
      </ul>

  </div>
  {{/if}}

  <!-- we show this as a way to artificially extend the page height, which is used to enable placing the search bar at the top of the page, 
  no matter how big the page is. this is important for mobile since the keyboard can get in the way of search results without being able to scroll -->
  <div id="height-extender" style="height: 1000px; display:none;"></div>
  {{else}}
    Playlist either does not exist or is private. 
    <br/>
    <br/>
    For private playlists, you must be sent a shareable URL from the owner for access.
  {{/if}}
</template>